For a backtest, I wanted to study the marginal profitability of lowering the moneyness of a put (to pay less for it). 
I derived the code for calls in order to test new strategies. 

Here are all the inputs you need for both codes: 

Spot price
Implied Volatility
Dividend yield
Risk-free rate 
Time to maturity (T)
Moneyness (M)

NB: customize the access paths
